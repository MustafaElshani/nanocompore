<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Compare nanopore signal to find modifications"><link rel="canonical" href="http://nanocompore.rna.rocks/demo/SampComp_usage/"><meta name="author" content="Adrien Leger & Tommaso Leonardi"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Compare samples with SampComp - Nanocompore</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><script src="../../assets/javascripts/modernizr.74668098.js"></script><link rel="stylesheet" href="../../assets/fonts/material-icons.css"></head><body dir="ltr"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#compare-samples-with-sampcomp" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="http://nanocompore.rna.rocks" title="Nanocompore" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">Nanocompore</span><span class="md-header-nav__topic">Compare samples with SampComp</span></div></div><div class="md-flex__cell md-flex__cell--shrink"></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/tleonardi/nanocompore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">tleonardi/nanocompore</div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="http://nanocompore.rna.rocks" title="Nanocompore" class="md-nav__button md-logo"><i class="md-icon"></i></a>Nanocompore</label><div class="md-nav__source"><a href="https://github.com/tleonardi/nanocompore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">tleonardi/nanocompore</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../.." title="Home" class="md-nav__link">Home</a></li><li class="md-nav__item"><a href="../../installation/" title="Installation instructions" class="md-nav__link">Installation instructions</a></li><li class="md-nav__item"><a href="../../data_preparation/" title="Data preparation" class="md-nav__link">Data preparation</a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked><label class="md-nav__link" for="nav-4">Usage</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Usage</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../usage/" title="How to use Nanocompore" class="md-nav__link">How to use Nanocompore</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Compare samples with SampComp</label><a href="./" title="Compare samples with SampComp" class="md-nav__link md-nav__link--active">Compare samples with SampComp</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#in-brief" title="In brief" class="md-nav__link">In brief</a></li><li class="md-nav__item"><a href="#quick-start" title="Quick start" class="md-nav__link">Quick start</a></li><li class="md-nav__item"><a href="#description-of-main-options" title="Description of main options" class="md-nav__link">Description of main options</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#sample-files" title="Sample files" class="md-nav__link">Sample files</a></li><li class="md-nav__item"><a href="#transcriptome-reference-fasta-file" title="Transcriptome reference FASTA file" class="md-nav__link">Transcriptome reference FASTA file</a></li><li class="md-nav__item"><a href="#output-folder" title="Output folder" class="md-nav__link">Output folder</a></li><li class="md-nav__item"><a href="#genome-annotation-bed-file" title="Genome annotation BED file" class="md-nav__link">Genome annotation BED file</a></li><li class="md-nav__item"><a href="#statistical-options" title="Statistical options" class="md-nav__link">Statistical options</a></li><li class="md-nav__item"><a href="#coverage-options" title="Coverage options" class="md-nav__link">Coverage options</a></li><li class="md-nav__item"><a href="#manually-exclude-or-include-references-api-only" title="Manually exclude or include references (API only)" class="md-nav__link">Manually exclude or include references (API only)</a></li></ul></nav></li><li class="md-nav__item"><a href="#advanced-api-usage" title="Advanced API Usage" class="md-nav__link">Advanced API Usage</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#import-the-package" title="Import the package" class="md-nav__link">Import the package</a></li><li class="md-nav__item"><a href="#using-a-python-dictionary-to-specify-the-locations-of-the-eventalign-files" title="Using a Python dictionary to specify the locations of the eventalign files" class="md-nav__link">Using a Python dictionary to specify the locations of the eventalign files</a></li><li class="md-nav__item"><a href="#using-a-yaml-file-instead-to-specify-the-files-location" title="Using a YAML file instead to specify the files location" class="md-nav__link">Using a YAML file instead to specify the files location</a></li><li class="md-nav__item"><a href="#tweaking-the-statistical-tests" title="Tweaking the statistical tests" class="md-nav__link">Tweaking the statistical tests</a></li><li class="md-nav__item"><a href="#explore-the-database-object-returned-by-sampcomp" title="Explore the database object returned by Sampcomp" class="md-nav__link">Explore the database object returned by Sampcomp</a></li></ul></nav></li><li class="md-nav__item"><a href="#full-cli-and-api-documentations" title="Full CLI and API documentations" class="md-nav__link">Full CLI and API documentations</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#api-documentation" title="API documentation" class="md-nav__link">API documentation</a></li><li class="md-nav__item"><a href="#cli-documentation" title="CLI documentation" class="md-nav__link">CLI documentation</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../SampCompDB_usage/" title="Generate plots and tables with SampCompDB" class="md-nav__link">Generate plots and tables with SampCompDB</a></li><li class="md-nav__item"><a href="../SimReads_usage/" title="Generate simulated reads" class="md-nav__link">Generate simulated reads</a></li></ul></nav></li><li class="md-nav__item"><a href="../../alternative/" title="Alternative and complementary packages" class="md-nav__link">Alternative and complementary packages</a></li><li class="md-nav__item"><a href="../../citing/" title="Citing" class="md-nav__link">Citing</a></li><li class="md-nav__item"><a href="../../contributing/" title="Contributing" class="md-nav__link">Contributing</a></li><li class="md-nav__item"><a href="../../code_of_conduct/" title="Code of conduct" class="md-nav__link">Code of conduct</a></li><li class="md-nav__item"><a href="../../licence/" title="Licence" class="md-nav__link">Licence</a></li><li class="md-nav__item"><a href="../../changelog/" title="Changelog" class="md-nav__link">Changelog</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#in-brief" title="In brief" class="md-nav__link">In brief</a></li><li class="md-nav__item"><a href="#quick-start" title="Quick start" class="md-nav__link">Quick start</a></li><li class="md-nav__item"><a href="#description-of-main-options" title="Description of main options" class="md-nav__link">Description of main options</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#sample-files" title="Sample files" class="md-nav__link">Sample files</a></li><li class="md-nav__item"><a href="#transcriptome-reference-fasta-file" title="Transcriptome reference FASTA file" class="md-nav__link">Transcriptome reference FASTA file</a></li><li class="md-nav__item"><a href="#output-folder" title="Output folder" class="md-nav__link">Output folder</a></li><li class="md-nav__item"><a href="#genome-annotation-bed-file" title="Genome annotation BED file" class="md-nav__link">Genome annotation BED file</a></li><li class="md-nav__item"><a href="#statistical-options" title="Statistical options" class="md-nav__link">Statistical options</a></li><li class="md-nav__item"><a href="#coverage-options" title="Coverage options" class="md-nav__link">Coverage options</a></li><li class="md-nav__item"><a href="#manually-exclude-or-include-references-api-only" title="Manually exclude or include references (API only)" class="md-nav__link">Manually exclude or include references (API only)</a></li></ul></nav></li><li class="md-nav__item"><a href="#advanced-api-usage" title="Advanced API Usage" class="md-nav__link">Advanced API Usage</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#import-the-package" title="Import the package" class="md-nav__link">Import the package</a></li><li class="md-nav__item"><a href="#using-a-python-dictionary-to-specify-the-locations-of-the-eventalign-files" title="Using a Python dictionary to specify the locations of the eventalign files" class="md-nav__link">Using a Python dictionary to specify the locations of the eventalign files</a></li><li class="md-nav__item"><a href="#using-a-yaml-file-instead-to-specify-the-files-location" title="Using a YAML file instead to specify the files location" class="md-nav__link">Using a YAML file instead to specify the files location</a></li><li class="md-nav__item"><a href="#tweaking-the-statistical-tests" title="Tweaking the statistical tests" class="md-nav__link">Tweaking the statistical tests</a></li><li class="md-nav__item"><a href="#explore-the-database-object-returned-by-sampcomp" title="Explore the database object returned by Sampcomp" class="md-nav__link">Explore the database object returned by Sampcomp</a></li></ul></nav></li><li class="md-nav__item"><a href="#full-cli-and-api-documentations" title="Full CLI and API documentations" class="md-nav__link">Full CLI and API documentations</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#api-documentation" title="API documentation" class="md-nav__link">API documentation</a></li><li class="md-nav__item"><a href="#cli-documentation" title="CLI documentation" class="md-nav__link">CLI documentation</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/tleonardi/nanocompore/edit/master/docs/demo/SampComp_usage.ipynb" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1 id="compare-samples-with-sampcomp">Compare samples with SampComp</h1>
<h2 id="in-brief">In brief</h2>
<p>First, <code class="codehilite"><span class="n">SampComp</span></code> parses the sample eventalign collapse files and then the observed results are piled-up per reference at position level. In a second time, positions are compared using various statistical methods and the statistics are stored in a shelve DBM database containing the results for all positions with sufficient coverage. The API returns a <code class="codehilite"><span class="n">SampCompDB</span></code> database wrapper object that can be subsequently interrogated to extract data and plots.</p>
<h2 id="quick-start">Quick start</h2>
<p>Example CLI call</p>
<div class="codehilite"><pre><span></span>nanocompore sampcomp <span class="se">\</span>
    --file_list1 ./data/S1_R1.tsv,./data/S1_R2.tsv <span class="se">\</span>
    --file_list2 ./data/S2_R1.tsv,./data/S2_R2.tsv <span class="se">\</span>
    --label1 S1 <span class="se">\</span>
    --label2 S2 <span class="se">\</span>
    --fasta ./reference/ref.fa <span class="se">\</span>
    --outpath ./results/ <span class="se">\</span>
</pre></div>

<p>Example API call</p>
<div class="codehilite"><pre><span></span><span class="c1"># Import package</span>
<span class="kn">from</span> <span class="nn">nanocompore.SampComp</span> <span class="kn">import</span> <span class="n">SampComp</span>

<span class="c1"># Init the object</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">SampComp</span><span class="p">(</span>
    <span class="n">eventalign_fn_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;S1&#39;</span><span class="p">:{</span><span class="s1">&#39;rep1&#39;</span><span class="p">:</span><span class="s1">&#39;./data/S1_R1.tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;rep2&#39;</span><span class="p">:</span><span class="s1">&#39;./data/S1_R2.tsv&#39;</span><span class="p">},</span>
        <span class="s1">&#39;S2&#39;</span><span class="p">:{</span><span class="s1">&#39;rep1&#39;</span><span class="p">:</span><span class="s1">&#39;./data/S2_R1.tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;rep2&#39;</span><span class="p">:</span><span class="s1">&#39;./data/S2_R2.tsv&#39;</span><span class="p">}},</span>
    <span class="n">outpath</span> <span class="o">=</span> <span class="s2">&quot;./results/&quot;</span><span class="p">,</span>
    <span class="n">fasta_fn</span> <span class="o">=</span> <span class="s2">&quot;./reference/ref.fa&quot;</span><span class="p">)</span>

<span class="c1"># Run the analysis</span>
<span class="n">s</span><span class="p">()</span>
</pre></div>

<h2 id="description-of-main-options">Description of main options</h2>
<p><code class="codehilite"><span class="n">SampComp</span></code> provides a very flexible analysis framework with a few mandatory options and many optional parameters. The full CLI and API documentations are provided at the bottom of this page.</p>
<h4 id="sample-files">Sample files</h4>
<p><code class="codehilite"><span class="n">SampComp</span></code> requires sample files obtained with <code class="codehilite"><span class="n">NanopolishComp</span> <span class="n">EventalignCollapse</span></code> as explained before (see <a href="data_preparation.md">data preparation</a>) for both the control and the experimental conditions. 2 conditions are expected and at least 2 replicates per conditions are highly recommended. If <code class="codehilite"><span class="n">SampComp</span></code> is called through the CLI the files can be provided using either relevant command options or a YAML file. With the Python API you can pass either a python dictionary or a YAML file.</p>
<div class="admonition info">
<p class="admonition-title">YAML file option (CLI or API)</p>
<p>This option allows to pass a YAML formatted file indicating the sample condition labels and paths to data files with the option <code class="codehilite"><span class="c1">--sample_yaml</span></code> for the CLI or directly with <code class="codehilite"><span class="n">eventalign_fn_dict</span></code> for the API. The file should be formatted as follow:</p>
<div class="codehilite"><pre><span></span><span class="nt">WT</span><span class="p">:</span>
    <span class="nt">rep1</span><span class="p">:</span>   <span class="l l-Scalar l-Scalar-Plain">./data/S1_R1.tsv</span>
    <span class="nt">rep2</span><span class="p">:</span>   <span class="l l-Scalar l-Scalar-Plain">./data/S1_R2.tsv</span>

<span class="nt">KO</span><span class="p">:</span>
    <span class="nt">rep1</span><span class="p">:</span>   <span class="l l-Scalar l-Scalar-Plain">./data/S2_R1.tsv</span>
    <span class="nt">rep2</span><span class="p">:</span>   <span class="l l-Scalar l-Scalar-Plain">./data/S1_R2.tsv</span>
</pre></div>

</div>
<div class="admonition info">
<p class="admonition-title">Command line option (CLI only)</p>
<p>This option requires to provide a comma separated list of files per condition using <code class="codehilite"><span class="c1">--file_list1</span></code> and <code class="codehilite"><span class="c1">--file_list2</span></code> arguments as well as the labels for condition each conditions using <code class="codehilite"><span class="c1">--label1</span></code> and <code class="codehilite"><span class="c1">--label2</span></code>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Python dictionary (API only)</p>
<p>This option allows to pass a multi-level python dictionary containing the sample condition labels and paths to data files. The dictionary should be formatted as follow:</p>
<div class="codehilite"><pre><span></span><span class="n">eventalign_fn_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;WT&quot;</span><span class="p">:</span>  <span class="p">{</span><span class="s2">&quot;rep1&quot;</span><span class="p">:</span><span class="s2">&quot;./data/S1_R1.tsv&quot;</span><span class="p">,</span> <span class="s2">&quot;rep2&quot;</span><span class="p">:</span><span class="s2">&quot;./data/S1_R2.tsv&quot;</span><span class="p">},</span>
    <span class="s2">&quot;KO&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;rep1&quot;</span><span class="p">:</span><span class="s2">&quot;./data/S2_R1.tsv&quot;</span><span class="p">,</span> <span class="s2">&quot;rep2&quot;</span><span class="p">:</span><span class="s2">&quot;./data/S1_R2.tsv&quot;</span><span class="p">}</span>
    <span class="p">}</span>
</pre></div>

</div>
<h4 id="transcriptome-reference-fasta-file">Transcriptome reference FASTA file</h4>
<p>A transcriptome FASTA reference file is required to extract kmer sequences during the analyses. The reference has to be the same as the one used at the mapping step. (CLI: <code class="codehilite"><span class="c1">--fasta</span></code>, API: <code class="codehilite"><span class="n">fasta_fn</span></code>)</p>
<h4 id="output-folder">Output folder</h4>
<p>Although it is not mandatory, it is recommended to provide a path to a directory where the program will output the result files  (CLI: <code class="codehilite"><span class="c1">--outpath</span></code>, API: <code class="codehilite"><span class="n">outpath</span></code>). In addition, users can also specify a prefix for the files to be generated (CLI: <code class="codehilite"><span class="c1">--outprefix</span></code>, API: <code class="codehilite"><span class="n">outprefix</span></code>). Finally, if the outpath directory already exists, the program will raise an error to avoid erasing result files. To ignore the error you can to specify to overwrite previous results (CLI: <code class="codehilite"><span class="c1">--overwrite</span></code>, API: <code class="codehilite"><span class="n">overwrite</span></code>).</p>
<h4 id="genome-annotation-bed-file">Genome annotation BED file</h4>
<p>Optionally, a BED file containing the genome annotations corresponding to the transcriptome fasta file can be provided. In that case Nanocompore will also convert the transcript coordinates into the genome space (CLI: <code class="codehilite"><span class="c1">--bed</span></code>, API: <code class="codehilite"><span class="n">bed_fn</span></code>)</p>
<h4 id="statistical-options">Statistical options</h4>
<p><code class="codehilite"><span class="n">SampComp</span></code> implements several statistical methods to evaluate the difference between the 2 conditions (<code class="codehilite"><span class="n">comparison_method</span></code>).</p>
<ul>
<li>Gaussian Mixture Model = GMM (default)</li>
<li>Kolmogorov–Smirnov test = KS (default)</li>
<li>Mann–Whitney U test = MW</li>
<li>T-test = TT</li>
</ul>
<p>In addition, it is also possible to specify the number of adjacent positions to take into account for the pvalue calculation (<code class="codehilite"><span class="n">sequence_context</span></code>) as well as the weights to give to adjacent position, using either an "uniform" or a "harmonic" distribution (<code class="codehilite"><span class="n">sequence_context_weights</span></code>).</p>
<h4 id="coverage-options">Coverage options</h4>
<p>The default coverage threshold for <code class="codehilite"><span class="n">SampComp</span></code> to perform a statistical test is 30 reads in each replicates. This is quite conservative and can be modified if needed (<code class="codehilite"><span class="n">min_coverage</span></code>). In addition, to reduce the computational burden it is possible to randomly down-sample the number of reads for high coverage references (<code class="codehilite"><span class="n">downsample_high_coverage</span></code>).</p>
<h4 id="manually-exclude-or-include-references-api-only">Manually exclude or include references (API only)</h4>
<p>The API allows to specify references to be included or excluded from the analysis (<code class="codehilite"><span class="n">select_ref_id</span></code> and
<code class="codehilite"><span class="n">exclude_ref_id</span></code>). This can be useful to analyse a specific set of transcripts or to run a small test before analysing the whole dataset.</p>
<h2 id="advanced-api-usage">Advanced API Usage</h2>
<h3 id="import-the-package">Import the package</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">nanocompore.SampComp</span> <span class="kn">import</span> <span class="n">SampComp</span>
</pre></div>

<h3 id="using-a-python-dictionary-to-specify-the-locations-of-the-eventalign-files">Using a Python dictionary to specify the locations of the eventalign files</h3>
<p>Default option using a multilevel dictionary.</p>
<div class="codehilite"><pre><span></span><span class="c1"># Init the object</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">SampComp</span> <span class="p">(</span> 
    <span class="n">eventalign_fn_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;KO&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;rep1&quot;</span><span class="p">:</span><span class="s1">&#39;./eventalign_files/yeast/KO_1_eventalign_collapsed.tsv&#39;</span><span class="p">,</span> 
            <span class="s2">&quot;rep2&quot;</span><span class="p">:</span><span class="s2">&quot;./eventalign_files/yeast/KO_2_eventalign_collapsed.tsv&quot;</span><span class="p">},</span>
        <span class="s2">&quot;WT&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;rep1&quot;</span><span class="p">:</span><span class="s1">&#39;./eventalign_files/yeast/WT_1_eventalign_collapsed.tsv&#39;</span><span class="p">,</span> 
            <span class="s2">&quot;rep2&quot;</span><span class="p">:</span><span class="s2">&quot;./eventalign_files/yeast/WT_2_eventalign_collapsed.tsv&quot;</span><span class="p">}},</span>
    <span class="n">outpath</span> <span class="o">=</span> <span class="s2">&quot;./results&quot;</span><span class="p">,</span>
    <span class="n">outprefix</span><span class="o">=</span> <span class="s2">&quot;yeast_&quot;</span><span class="p">,</span>
    <span class="n">fasta_fn</span> <span class="o">=</span> <span class="s2">&quot;./references/yeast/Yeast_transcriptome.fa&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># Run the analysis</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">s</span><span class="p">()</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">Initialising</span> <span class="n">SampComp</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Initialising</span> <span class="n">Whitelist</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Reading</span> <span class="n">eventalign</span> <span class="k">index</span> <span class="n">files</span>
    <span class="k">References</span> <span class="k">found</span> <span class="k">in</span> <span class="k">index</span><span class="p">:</span> <span class="mi">125</span>
<span class="n">Filtering</span> <span class="k">out</span> <span class="k">references</span> <span class="k">with</span> <span class="n">low</span> <span class="n">coverage</span>
    <span class="k">References</span> <span class="n">remaining</span> <span class="k">after</span> <span class="n">reference</span> <span class="n">coverage</span> <span class="n">filtering</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Starting</span> <span class="k">data</span> <span class="n">processing</span>
<span class="mi">100</span><span class="o">%|</span><span class="err">██████████</span><span class="o">|</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">25</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mi">25</span><span class="p">.</span><span class="mi">07</span><span class="n">s</span><span class="o">/</span> <span class="n">Processed</span> <span class="k">References</span><span class="p">]</span>
<span class="n">Loading</span> <span class="n">SampCompDB</span>
<span class="n">Calculate</span> <span class="n">results</span>
</pre></div>


<h3 id="using-a-yaml-file-instead-to-specify-the-files-location">Using a YAML file instead to specify the files location</h3>
<p>To use a YAML file, just pass a path to the file instead of a dictionary. In this example we also specify to use 10 threads to speed-up the data processing (<code class="codehilite"><span class="n">nthreads</span> <span class="o">=</span> <span class="mi">10</span></code>). </p>
<div class="codehilite"><pre><span></span><span class="c1"># Read YAML file to display structure</span>
<span class="k">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./samples.yaml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">Modified</span><span class="o">:</span>
    <span class="n">rep1</span><span class="o">:</span>   <span class="o">./</span><span class="n">eventalign_files</span><span class="sr">/simulated/</span><span class="n">modified_rep_1</span><span class="o">.</span><span class="na">tsv</span>
    <span class="n">rep2</span><span class="o">:</span>   <span class="o">./</span><span class="n">eventalign_files</span><span class="sr">/simulated/</span><span class="n">modified_rep_2</span><span class="o">.</span><span class="na">tsv</span>
<span class="n">Unmodified</span><span class="o">:</span>
    <span class="n">rep1</span><span class="o">:</span>   <span class="o">./</span><span class="n">eventalign_files</span><span class="sr">/simulated/</span><span class="n">unmodified_rep_1</span><span class="o">.</span><span class="na">tsv</span>
    <span class="n">rep2</span><span class="o">:</span>   <span class="o">./</span><span class="n">eventalign_files</span><span class="sr">/simulated/</span><span class="n">unmodified_rep_2</span><span class="o">.</span><span class="na">tsv</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1"># Init the object</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">SampComp</span> <span class="p">(</span>
    <span class="n">eventalign_fn_dict</span> <span class="o">=</span> <span class="s2">&quot;./samples.yaml&quot;</span><span class="p">,</span>
    <span class="n">outpath</span><span class="o">=</span> <span class="s2">&quot;./results&quot;</span><span class="p">,</span>
    <span class="n">outprefix</span><span class="o">=</span> <span class="s2">&quot;simulated_&quot;</span><span class="p">,</span>
    <span class="n">fasta_fn</span> <span class="o">=</span> <span class="s2">&quot;./references/simulated/ref.fa&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="n">nthreads</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Run the analysis</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">s</span> <span class="p">()</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">Initialising</span> <span class="n">SampComp</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Initialising</span> <span class="n">Whitelist</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Reading</span> <span class="n">eventalign</span> <span class="k">index</span> <span class="n">files</span>
    <span class="k">References</span> <span class="k">found</span> <span class="k">in</span> <span class="k">index</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Filtering</span> <span class="k">out</span> <span class="k">references</span> <span class="k">with</span> <span class="n">low</span> <span class="n">coverage</span>
    <span class="k">References</span> <span class="n">remaining</span> <span class="k">after</span> <span class="n">reference</span> <span class="n">coverage</span> <span class="n">filtering</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Starting</span> <span class="k">data</span> <span class="n">processing</span>
<span class="mi">100</span><span class="o">%|</span><span class="err">██████████</span><span class="o">|</span> <span class="mi">5</span><span class="o">/</span><span class="mi">5</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">41</span><span class="n">s</span><span class="o">/</span> <span class="n">Processed</span> <span class="k">References</span><span class="p">]</span>
<span class="n">Loading</span> <span class="n">SampCompDB</span>
<span class="n">Calculate</span> <span class="n">results</span>
</pre></div>


<h3 id="tweaking-the-statistical-tests">Tweaking the statistical tests</h3>
<p>In this example, we require all 4 possible statistical tests to be performed (<code class="codehilite"><span class="n">comparison_methods</span><span class="o">=</span><span class="p">[</span><span class="ss">&quot;GMM&quot;</span><span class="p">,</span> <span class="ss">&quot;MW&quot;</span><span class="p">,</span> <span class="ss">&quot;KS&quot;</span><span class="p">,</span> <span class="ss">&quot;TT&quot;</span><span class="p">]</span></code>), and we want a pvalue that takes into account 2 adjacent positions(<code class="codehilite"><span class="n">sequence_context</span><span class="o">=</span><span class="mi">2</span></code>). In addition we also specify that the weights for adjacent position should follow a harmonic distribution (<code class="codehilite"><span class="n">sequence_context_weights</span><span class="o">=</span><span class="ss">&quot;harmonic&quot;</span></code>). Finally, we also want the Gaussian mixture model to use the logistic regression test on top of the ANOVA (<code class="codehilite"><span class="n">logit</span> <span class="o">=</span> <span class="k">True</span></code>). </p>
<div class="codehilite"><pre><span></span><span class="c1"># Init the object</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">SampComp</span> <span class="p">(</span>
    <span class="n">eventalign_fn_dict</span> <span class="o">=</span> <span class="s2">&quot;./samples.yaml&quot;</span><span class="p">,</span>
    <span class="n">outpath</span> <span class="o">=</span> <span class="s2">&quot;./results/&quot;</span><span class="p">,</span>
    <span class="n">outprefix</span><span class="o">=</span> <span class="s2">&quot;simulated_stats_&quot;</span><span class="p">,</span>
    <span class="n">fasta_fn</span> <span class="o">=</span> <span class="s2">&quot;./references/simulated/ref.fa&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">comparison_methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GMM&quot;</span><span class="p">,</span> <span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="s2">&quot;KS&quot;</span><span class="p">,</span> <span class="s2">&quot;TT&quot;</span><span class="p">],</span>
    <span class="n">sequence_context</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">sequence_context_weights</span><span class="o">=</span><span class="s2">&quot;harmonic&quot;</span><span class="p">,</span>
    <span class="n">logit</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># Run the analysis</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">s</span> <span class="p">()</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">Initialising</span> <span class="n">SampComp</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Initialising</span> <span class="n">Whitelist</span> <span class="k">and</span> <span class="n">checking</span> <span class="k">options</span>
<span class="n">Reading</span> <span class="n">eventalign</span> <span class="k">index</span> <span class="n">files</span>
    <span class="k">References</span> <span class="k">found</span> <span class="k">in</span> <span class="k">index</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Filtering</span> <span class="k">out</span> <span class="k">references</span> <span class="k">with</span> <span class="n">low</span> <span class="n">coverage</span>
    <span class="k">References</span> <span class="n">remaining</span> <span class="k">after</span> <span class="n">reference</span> <span class="n">coverage</span> <span class="n">filtering</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Starting</span> <span class="k">data</span> <span class="n">processing</span>
<span class="mi">100</span><span class="o">%|</span><span class="err">██████████</span><span class="o">|</span> <span class="mi">5</span><span class="o">/</span><span class="mi">5</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">17</span><span class="o">&lt;</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">45</span><span class="n">s</span><span class="o">/</span> <span class="n">Processed</span> <span class="k">References</span><span class="p">]</span>
<span class="n">Loading</span> <span class="n">SampCompDB</span>
<span class="n">Calculate</span> <span class="n">results</span>
</pre></div>


<h3 id="explore-the-database-object-returned-by-sampcomp">Explore the database object returned by Sampcomp</h3>
<p>The database object returned by <code class="codehilite"><span class="n">Sampcomp</span></code> is a Python GDBM object database indexed by reference id. Although we highly recommend to used <code class="codehilite"><span class="n">SampCompDB</span></code> to extract information, it is also possible to open the database directly using the python standard library module <a href="https://docs.python.org/3.6/library/shelve.html">shelve</a>.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">shelve</span>

<span class="k">with</span> <span class="n">shelve</span><span class="o">.</span><span class="n">open</span> <span class="p">(</span><span class="s2">&quot;./results/simulated_SampComp.db&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
    <span class="c1"># Read metadata stored in metadata slot</span>
    <span class="k">print</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="s2">&quot;__metadata&quot;</span><span class="p">])</span>
    <span class="c1"># Read list of references ids stored in ref_id_list slot</span>
    <span class="k">print</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="s2">&quot;__ref_id_list&quot;</span><span class="p">])</span>
    <span class="c1"># Access stats for reference &#39;ref_0000&#39; in position 1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="s2">&quot;ref_0000&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;txComp&quot;</span><span class="p">])</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="err">{</span><span class="s1">&#39;package_name&#39;</span><span class="p">:</span> <span class="s1">&#39;nanocompore&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0rc3-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-06-19 14:11:42.582069&#39;</span><span class="p">,</span> <span class="s1">&#39;comparison_methods&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GMM&#39;</span><span class="p">,</span> <span class="s1">&#39;KS&#39;</span><span class="p">],</span> <span class="s1">&#39;pvalue_tests&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GMM_anova_pvalue&#39;</span><span class="p">,</span> <span class="s1">&#39;KS_dwell_pvalue&#39;</span><span class="p">,</span> <span class="s1">&#39;KS_intensity_pvalue&#39;</span><span class="p">],</span> <span class="s1">&#39;sequence_context&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;min_coverage&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;n_samples&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="err">}</span>
<span class="p">[</span><span class="s1">&#39;ref_0002&#39;</span><span class="p">,</span> <span class="s1">&#39;ref_0000&#39;</span><span class="p">,</span> <span class="s1">&#39;ref_0003&#39;</span><span class="p">,</span> <span class="s1">&#39;ref_0001&#39;</span><span class="p">,</span> <span class="s1">&#39;ref_0004&#39;</span><span class="p">]</span>
<span class="err">{</span><span class="s1">&#39;GMM_model&#39;</span><span class="p">:</span> <span class="err">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">covariance_type</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="s1">&#39;kmeans&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                <span class="n">means_init</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precisions_init</span><span class="o">=</span><span class="k">None</span><span class="p">,</span>
                <span class="n">random_state</span><span class="o">=&lt;</span><span class="n">mtrand</span><span class="p">.</span><span class="n">RandomState</span> <span class="k">object</span> <span class="k">at</span> <span class="mi">0</span><span class="n">x7ff59c481ee8</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="n">reg_covar</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">,</span> <span class="k">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">warm_start</span><span class="o">=</span><span class="k">False</span><span class="p">,</span> <span class="n">weights_init</span><span class="o">=</span><span class="k">None</span><span class="p">),</span> <span class="s1">&#39;cluster_counts&#39;</span><span class="p">:</span> <span class="s1">&#39;Modified_rep1:6/49__Modified_rep2:6/54__Unmodified_rep1:50/5__Unmodified_rep2:52/8&#39;</span><span class="err">}</span><span class="p">,</span> <span class="s1">&#39;GMM_anova_pvalue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0022723661815992765</span><span class="p">,</span> <span class="s1">&#39;GMM_anova_model&#39;</span><span class="p">:</span> <span class="err">{</span><span class="s1">&#39;pvalue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0022723661815992765</span><span class="p">,</span> <span class="s1">&#39;delta_logit&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">9703346955</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">:</span> <span class="n">F_onewayResult</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="mi">438</span><span class="p">.</span><span class="mi">5704870887501</span><span class="p">,</span> <span class="n">pvalue</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0022723661815992765</span><span class="p">),</span> <span class="s1">&#39;log_ratios&#39;</span><span class="p">:</span> <span class="nb">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">96611286</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">06142304</span><span class="p">,</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">14006616</span><span class="p">,</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">77306734</span><span class="p">])</span><span class="err">}</span><span class="p">,</span> <span class="s1">&#39;KS_intensity_pvalue&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">.</span><span class="mi">2306904419226962</span><span class="n">e</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;KS_dwell_pvalue&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0667209507829918</span><span class="n">e</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;shift_stats&#39;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;c1_mean_intensity&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">.</span><span class="mi">54709799468591</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_mean_intensity&#39;</span><span class="p">,</span> <span class="mi">91</span><span class="p">.</span><span class="mi">84415815799566</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c1_median_intensity&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">61305720731731</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_median_intensity&#39;</span><span class="p">,</span> <span class="mi">92</span><span class="p">.</span><span class="mi">05605629218894</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c1_sd_intensity&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">.</span><span class="mi">85551651760893</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_sd_intensity&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">.</span><span class="mi">143626863495356</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c1_mean_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">02567361308475615</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_mean_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">009745078440682191</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c1_median_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">023047132241771167</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_median_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">007591605413309661</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c1_sd_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">010681688969392145</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c2_sd_dwell&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">007203231747770627</span><span class="p">)])</span><span class="err">}</span>
</pre></div>


<h2 id="full-cli-and-api-documentations">Full CLI and API documentations</h2>
<h3 id="api-documentation">API documentation</h3>
<p>API help can be obtained with conventional python methods (help or ?) or rendered nicely in Jupyter with the jhelp function from nanocompore </p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">nanocompore.SampComp</span> <span class="kn">import</span> <span class="n">SampComp</span>
<span class="kn">from</span> <span class="nn">nanocompore.common</span> <span class="kn">import</span> <span class="n">jhelp</span>
<span class="n">jhelp</span><span class="p">(</span><span class="n">SampComp</span><span class="p">)</span>
</pre></div>

<p><strong>SampComp</strong> (eventalign_fn_dict, fasta_fn, bed_fn, outpath, outprefix, overwrite, whitelist, comparison_methods, logit, allow_warnings, sequence_context, sequence_context_weights, min_coverage, min_ref_length, downsample_high_coverage, max_invalid_kmers_freq, select_ref_id, exclude_ref_id, nthreads, log_level)</p>
<p>Init analysis and check args</p>
<hr />
<ul>
<li><strong>eventalign_fn_dict</strong> (required) [dict]</li>
</ul>
<p>Multilevel dictionnary indicating the condition_label, sample_label and file name of the eventalign_collapse output. 2 conditions are expected and at least 2 sample replicates per condition are highly recommended. One can also pass YAML file describing the samples instead. Example <code class="codehilite"><span class="n">d</span> <span class="o">=</span> <span class="err">{</span><span class="ss">&quot;S1&quot;</span><span class="p">:</span> <span class="err">{</span><span class="ss">&quot;R1&quot;</span><span class="p">:</span><span class="ss">&quot;path1.tsv&quot;</span><span class="p">,</span> <span class="ss">&quot;R2&quot;</span><span class="p">:</span><span class="ss">&quot;path2.tsv&quot;</span><span class="err">}</span><span class="p">,</span> <span class="ss">&quot;S2&quot;</span><span class="p">:</span> <span class="err">{</span><span class="ss">&quot;R1&quot;</span><span class="p">:</span><span class="ss">&quot;path3.tsv&quot;</span><span class="p">,</span> <span class="ss">&quot;R2&quot;</span><span class="p">:</span><span class="ss">&quot;path4.tsv&quot;</span><span class="err">}}</span></code></p>
<ul>
<li><strong>fasta_fn</strong> (required) [str]</li>
</ul>
<p>Path to a fasta file corresponding to the reference used for read alignment.</p>
<ul>
<li><strong>bed_fn</strong> (default: None) [str]</li>
</ul>
<p>Path to a BED file containing the annotation of the transcriptome used as reference when mapping.</p>
<ul>
<li><strong>outpath</strong> (default: results) [str]</li>
</ul>
<p>Path to the output folder.</p>
<ul>
<li><strong>outprefix</strong> (default: out_) [str]</li>
</ul>
<p>text outprefix for all the files generated by the function.</p>
<ul>
<li><strong>overwrite</strong> (default: False) [bool]</li>
</ul>
<p>If the output directory already exists, the standard behaviour is to raise an error to prevent overwriting existing data This option ignore the error and overwrite data if they have the same outpath and outprefix.</p>
<ul>
<li><strong>whitelist</strong> (default: None) [Whitelist]</li>
</ul>
<p>Whitelist object previously generated with nanocompore Whitelist. If not given, will be automatically generated.</p>
<ul>
<li><strong>comparison_methods</strong> (default: ['GMM', 'KS']) [list]</li>
</ul>
<p>Statistical method to compare the 2 samples (mann_whitney or MW, kolmogorov_smirnov or KS, t_test or TT, gaussian_mixture_model or GMM). This can be a list or a comma separated string. {MW,KS,TT,GMM}</p>
<ul>
<li><strong>logit</strong> (default: False) [bool]</li>
</ul>
<p>Force logistic regression even if we have less than 2 replicates in any condition.</p>
<ul>
<li><strong>allow_warnings</strong> (default: False) [bool]</li>
</ul>
<p>If True runtime warnings during the ANOVA tests don't raise an error.</p>
<ul>
<li><strong>sequence_context</strong> (default: 0) [int]</li>
</ul>
<p>Extend statistical analysis to contigous adjacent base if available.</p>
<ul>
<li><strong>sequence_context_weights</strong> (default: uniform) [str]</li>
</ul>
<p>type of weights to used for combining p-values. {uniform,harmonic}</p>
<ul>
<li><strong>min_coverage</strong> (default: 30) [int]</li>
</ul>
<p>minimal read coverage required in all sample.</p>
<ul>
<li><strong>min_ref_length</strong> (default: 100) [int]</li>
</ul>
<p>minimal length of a reference transcript to be considered in the analysis</p>
<ul>
<li><strong>downsample_high_coverage</strong> (default: 0) [int]</li>
</ul>
<p>For reference with higher coverage, downsample by randomly selecting reads.</p>
<ul>
<li><strong>max_invalid_kmers_freq</strong> (default: 0.1) [float]</li>
</ul>
<p>maximum frequency of NNNNN, mismatching and missing kmers in reads.</p>
<ul>
<li><strong>select_ref_id</strong> (default: []) [list]</li>
</ul>
<p>if given, only reference ids in the list will be selected for the analysis.</p>
<ul>
<li><strong>exclude_ref_id</strong> (default: []) [list]</li>
</ul>
<p>if given, refid in the list will be excluded from the analysis.</p>
<ul>
<li><strong>nthreads</strong> (default: 3) [int]</li>
</ul>
<p>Number of threads (two are used for reading and writing, all the others for parallel processing).</p>
<ul>
<li><strong>log_level</strong> (default: info) [str]</li>
</ul>
<p>Set the log level. {warning,info,debug}</p>
<h3 id="cli-documentation">CLI documentation</h3>
<div class="codehilite"><pre><span></span>nanocompore sampcomp --help
</pre></div>

<div class="codehilite"><pre><span></span>usage: nanocompore sampcomp [-h] [--sample_yaml sample_yaml]
                            [--file_list1 /path/to/Condition1_rep1,/path/to/Condition1_rep2]
                            [--file_list2 /path/to/Condition2_rep1,/path/to/Condition2_rep2]
                            [--label1 Condition1] [--label2 Condition2]
                            --fasta FASTA [--bed BED] [--outpath OUTPATH]
                            [--outprefix OUTPREFIX] [--overwrite]
                            [--max_invalid_kmers_freq MAX_INVALID_KMERS_FREQ]
                            [--min_coverage MIN_COVERAGE]
                            [--downsample_high_coverage DOWNSAMPLE_HIGH_COVERAGE]
                            [--min_ref_length MIN_REF_LENGTH]
                            [--comparison_methods COMPARISON_METHODS]
                            [--sequence_context {0,1,2,3,4}]
                            [--sequence_context_weights {uniform,harmonic}]
                            [--pvalue_thr PVALUE_THR] [--logit]
                            [--allow_warnings] [--nthreads NTHREADS]
                            [--log_level {warning,info,debug}]

Compare 2 samples and find significant signal

* Minimal example with file_list arguments

    nanocompore sampcomp -1 f1.tsv,f2.tsv -2 f3.tsv,f4.tsv -f ref.fa -o results
* Minimal example with sample YAML file

    nanocompore sampcomp -y samples.yaml -f ref -o results

optional arguments:
  -h, --help            show this help message and exit

YAML sample files:
  Option allowing to describe sample files in a YAML file

  --sample_yaml sample_yaml, -y sample_yaml
                        YAML file containing the sample file labels. See
                        formatting in documentation. (required if --file_list1
                        and --file_list2 not given)

Arguments sample files:
  Option allowing to describe sample files directly as command line arguments

  --file_list1 /path/to/Condition1_rep1,/path/to/Condition1_rep2, -1 /path/to/Condition1_rep1,/path/to/Condition1_rep2
                        Comma separated list of NanopolishComp files for label
                        1. (required if --sample_yaml not given)
  --file_list2 /path/to/Condition2_rep1,/path/to/Condition2_rep2, -2 /path/to/Condition2_rep1,/path/to/Condition2_rep2
                        Comma separated list of NanopolishComp files for label
                        2. (required if --sample_yaml not given)
  --label1 Condition1   Label for files in --file_list1 (default: Condition1)
  --label2 Condition2   Label for files in --file_list2 (default: Condition2)

Input/Output options:
  --fasta FASTA, -f FASTA
                        Fasta file used for mapping (required)
  --bed BED             BED file with annotation of transcriptome used for
                        mapping (optional)
  --outpath OUTPATH, -o OUTPATH
                        Path to the output folder (default: results)
  --outprefix OUTPREFIX, -p OUTPREFIX
                        text outprefix for all the files generated by the
                        function (default: out_)
  --overwrite           Use --outpath even if it exists already (default:
                        False)

Transcript filtering options:
  --max_invalid_kmers_freq MAX_INVALID_KMERS_FREQ
                        Max fequency of invalid kmers (default: 0.1)
  --min_coverage MIN_COVERAGE
                        Minimum coverage required in each condition to do the
                        comparison (default: 30)
  --downsample_high_coverage DOWNSAMPLE_HIGH_COVERAGE
                        Used for debug: transcripts with high covergage will
                        be downsampled (default: 0)
  --min_ref_length MIN_REF_LENGTH
                        Minimum length of a reference transcript to include it
                        in the analysis (default: 100)

Statistical testing options:
  --comparison_methods COMPARISON_METHODS
                        Comma separated list of comparison methods. Valid
                        methods are: GMM,KS,TT,MW. (default: GMM,KS)
  --sequence_context {0,1,2,3,4}
                        Sequence context for combining p-values (default: 0)
  --sequence_context_weights {uniform,harmonic}
                        Type of weights to use for combining p-values
  --pvalue_thr PVALUE_THR
                        Adjusted p-value threshold for reporting significant
                        sites (default: 0.05)
  --logit               Use logistic regression testing also when all
                        conditions have replicates (default: False)
  --allow_warnings      If True runtime warnings during the ANOVA tests don&#39;t
                        raise an error (default: False)

Other options:
  --nthreads NTHREADS, -t NTHREADS
                        Number of threads (default: 3)
  --log_level {warning,info,debug}
                        log level (default: info)
</pre></div></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../../usage/" title="How to use Nanocompore" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>How to use Nanocompore</span></div></a><a href="../SampCompDB_usage/" title="Generate plots and tables with SampCompDB" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Generate plots and tables with SampCompDB</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Copyright &copy; 2019 Adrien Leger & Tommaso Leonardi</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script></body></html>